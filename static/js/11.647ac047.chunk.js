(this["webpackJsonp@dashboard/web"]=this["webpackJsonp@dashboard/web"]||[]).push([[11],{101:function(e,a,t){"use strict";a.a=function(e){return e?e.toLocaleString():0}},179:function(e,a,t){"use strict";t.r(a);var n=t(19),l=t(0),r=t.n(l),i=t(106),s=t(211),c=t(210),u=t(30),o=t(31),d=t.n(o),m=t(32),v=t(40),b=t.n(v),f=function(){var e=Object(m.a)(d.a.mark((function e(){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("https://c19pub.azureedge.net/assets/dispatch/website_timestamp");case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p={date:"date",name:"areaName",cases:{daily:"newCasesByPublishDate",cumulative:"cumCasesByPublishDate"},deaths:{daily:"newDeaths28DaysByPublishDate",cumulative:"cumDeaths28DaysByPublishDate"},tests:{pillarOne:"newPillarOneTestsByPublishDate",pillarTwo:"newPillarTwoTestsByPublishDate",pillarThree:"newPillarThreeTestsByPublishDate",pillarFour:"newPillarFourTestsByPublishDate"},hospital:{dailyAdmissions:"newAdmissions",totalAdmissions:"cumAdmissions",ventilatorBeds:"covidOccupiedMVBeds",hospitalCases:"hospitalCases"}},h=function(){var e=Object(m.a)(d.a.mark((function e(a){var t,n,l,r,i,s,c=arguments;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:null,n=t?"&".concat(t):"",l="filters=".concat(a.join(";")).concat(n,"&structure=").concat(JSON.stringify(p)),r=encodeURI(l),console.log("apiParams",l),i="https://api.coronavirus.data.gov.uk/v1/data?".concat(r),e.next=7,b.a.get(i);case 7:return s=e.sent,e.abrupt("return",s.data);case 9:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),y=t(107),O=t(168),D=t(18),E=t.n(D),g={loading:!0,lastUpdatedAt:null,error:null,nationDailyRecords:null,overview:null,nationNewCases:null,nationNewDeaths:null,regionalTotalCases:null,hospitalRecords:null},j=t(101),w=function(e){return e.pillarOne+e.pillarTwo+e.pillarThree+e.pillarFour},A=function(e,a){var t=e.filter((function(e){return e.date===a})),n=E()(a).subtract(1,"days").format("YYYY-MM-DD"),l=e.filter((function(e){return e.date===n}));return t.map((function(e){var a=e.name,t=e.cases,n=e.deaths,r=e.tests,i=l.find((function(e){return e.name===a}));return[{value:a,align:"left"},{value:Object(j.a)(t.daily),delta:Object(j.a)(t.daily-i.cases.daily),align:"right"},{value:Object(j.a)(n.daily),delta:Object(j.a)(n.daily-i.deaths.daily),align:"right"},{value:Object(j.a)(w(r)),delta:Object(j.a)(w(r)-w(i.tests)),align:"right"}]}))},T=function(e){return e.map((function(e){var a=e.name,t=e.hospital;return[a,Object(j.a)(t.dailyAdmissions),Object(j.a)(t.ventilatorBeds),Object(j.a)(t.hospitalCases)]}))},C=function(e){var a=e.cases,t=e.deaths;return{totalCases:a.cumulative,dailyCases:a.daily,dailyDeaths:t.daily,totalDeaths:t.cumulative}},R=function(e){return e.map((function(e){return{date:e.date,cases:e.cases.daily}})).reverse()},S=function(e){return e.map((function(e){return{date:e.date,deaths:e.deaths.daily}})).reverse()},B=function(e){return e.map((function(e){var a=e.cases;return{name:e.name,totalCases:a.cumulative}}))},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,a=arguments.length>1?arguments[1]:void 0,t=a.type,n=a.payload;if("FETCH_DASHBOARD_DATA_START"===t)return Object(O.a)(Object(O.a)({},e),{},{loading:!0});if("FETCH_DASHBOARD_DATA_SUCCESS"===t){var l=n.date,r=n.nationOverview,i=n.nationData,s=n.dailyRegionData,c=E()(l).format("YYYY-MM-DD"),u=i.filter((function(e){return e.date===c})),o=r.find((function(e){return e.date===c}));return Object(O.a)(Object(O.a)({},e),{},{loading:!1,lastUpdatedAt:l,nationDailyRecords:A(i,c),overview:C(o),nationNewCases:R(r),nationNewDeaths:S(r),regionalTotalCases:B([].concat(Object(y.a)(u),Object(y.a)(s))),hospitalRecords:T(u)})}return"FETCH_DASHBOARD_DATA_ERROR"===t?Object(O.a)(Object(O.a)({},e),{},{loading:!1,error:n}):void 0},P=function(){var e=Object(l.useReducer)(_,g),a=Object(n.a)(e,2),t=a[0],r=a[1];return{state:t,fetchDashboardData:Object(l.useCallback)(Object(m.a)(d.a.mark((function e(){var a,t,l,i,s,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({type:"FETCH_DASHBOARD_DATA_START",payload:void 0}),e.prev=1,e.next=4,Promise.all([f(),h(["areaType=overview"]),h(["areaType=nation"]),h(["areaType=region"],"latestBy=cumCasesByPublishDate")]);case 4:a=e.sent,t=Object(n.a)(a,4),l=t[0],i=t[1],s=t[2],c=t[3],r({type:"FETCH_DASHBOARD_DATA_SUCCESS",payload:{date:l,nationOverview:i.data,nationData:s.data,dailyRegionData:c.data}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),r({type:"FETCH_DASHBOARD_DATA_ERROR",payload:e.t0.message});case 16:case"end":return e.stop()}}),e,null,[[1,13]])}))),[])}},k=Object(l.lazy)((function(){return Promise.all([t.e(4),t.e(12),t.e(14)]).then(t.bind(null,232))})),z=Object(l.lazy)((function(){return Promise.all([t.e(4),t.e(15)]).then(t.bind(null,212))})),H=Object(l.lazy)((function(){return Promise.all([t.e(17),t.e(20)]).then(t.bind(null,213))})),N=(Object(l.lazy)((function(){return t.e(23).then(t.bind(null,215))})),Object(l.lazy)((function(){return t.e(18).then(t.bind(null,216))})),Object(l.lazy)((function(){return t.e(22).then(t.bind(null,217))}))),x=(Object(l.lazy)((function(){return t.e(25).then(t.bind(null,218))})),Object(l.lazy)((function(){return t.e(24).then(t.bind(null,233))}))),F=Object(l.lazy)((function(){return t.e(16).then(t.bind(null,219))})),U=Object(l.lazy)((function(){return t.e(13).then(t.bind(null,220))}));Object(l.lazy)((function(){return t.e(21).then(t.bind(null,221))})),Object(l.lazy)((function(){return t.e(19).then(t.bind(null,222))})),a.default=function(){var e=Object(l.useState)(u.a.OneMonth),a=Object(n.a)(e,2),t=a[0],o=a[1],d=P(),m=d.state,v=d.fetchDashboardData;Object(l.useEffect)((function(){v()}),[v]);var b=Object(i.c)(5,{from:{transform:"translate3d(0, 30px, 0)",opacity:0},transform:"translate3d(0, 0px, 0)",opacity:1,config:{mass:1,tension:2e3,friction:200}});return m&&m.loading?r.a.createElement("div",{className:"loading"},r.a.createElement(c.a,null)):(console.log("state",m),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"banner"},"UK Covid19 Dashboard"),r.a.createElement("div",{className:"dashboard-grid"},r.a.createElement(s.a,{container:!0,spacing:3,justify:"center"},r.a.createElement(s.a,{item:!0,xs:12,sm:12,md:4},r.a.createElement(l.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(x,{overview:null===m||void 0===m?void 0:m.overview,lastUpdatedAt:null===m||void 0===m?void 0:m.lastUpdatedAt})),r.a.createElement(l.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(i.a.div,{style:b[1]},r.a.createElement(N,{nationDailyRecords:null===m||void 0===m?void 0:m.nationDailyRecords})))),r.a.createElement(s.a,{item:!0,xs:12,sm:12,md:4},r.a.createElement(i.a.h2,{className:"map-title",style:b[4]},"UK Map"),r.a.createElement(l.Suspense,{fallback:r.a.createElement("div",{style:{minHeight:"100vh"}})},r.a.createElement(i.a.div,{style:b[3]},r.a.createElement(k,{regionalTotalCases:null===m||void 0===m?void 0:m.regionalTotalCases}))),r.a.createElement(l.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(i.a.div,{style:b[3]},r.a.createElement(z,null))),r.a.createElement(l.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(i.a.div,{style:b[1]},r.a.createElement(F,{newCases:null===m||void 0===m?void 0:m.nationNewCases,dateRange:t}))),r.a.createElement(l.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(i.a.div,{style:b[2]},r.a.createElement(U,{newDeaths:null===m||void 0===m?void 0:m.nationNewDeaths,dateRange:t}))),r.a.createElement(l.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(i.a.div,{style:b[2]},r.a.createElement(H,{chartDateRange:t,onDateRangeChange:o}))))))))}},30:function(e,a,t){"use strict";var n;!function(e){e.Beginning="1",e.OneMonth="2",e.TwoWeeks="3"}(n||(n={})),a.a=n}}]);
//# sourceMappingURL=11.647ac047.chunk.js.map